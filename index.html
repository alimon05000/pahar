<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>IronHome ‚Äî –ì—Ä—É–¥—å & –†—É–∫–∏</title>
  <meta name="theme-color" content="#111111" />
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="data:image/svg+xml;utf8,<?xml version='1.0'?><?xml-stylesheet type='text/css' href='#'?> <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'><defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='1'><stop stop-color='%23a8ff78'/><stop offset='1' stop-color='%238af3ff'/></linearGradient></defs><rect width='128' height='128' rx='24' fill='url(%23g)'/><text x='50%' y='56%' dominant-baseline='middle' text-anchor='middle' font-size='74' font-family='system-ui,Segoe UI,Roboto' fill='%23000' opacity='.85'>üè†</text></svg>">

  <style>
    :root {
      --bg: #0b0c0f;
      --card: rgba(255,255,255,0.06);
      --elev: rgba(255,255,255,0.15);
      --txt: #e6e6e6;
      --muted: #a9b0bd;
      --acc: #77e0ff;
      --ok: #80ffb0;
      --warn: #ffd36b;
      --err: #ff7a7a;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
      --blur: blur(12px);
    }
    /* Light theme */
    [data-theme="light"] {
      --bg: #f5f7fb;
      --card: rgba(255,255,255,.9);
      --elev: rgba(0,0,0,.06);
      --txt: #0a0c10;
      --muted: #566074;
      --acc: #2264ff;
      --ok: #0ca678;
      --warn: #f08c00;
      --err: #d6336c;
      --shadow: 0 10px 30px rgba(0,0,0,.12);
    }
    /* Aurora theme (–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è) */
    [data-theme="aurora"] body {
      background:
        radial-gradient(1200px 800px at 10% 10%, rgba(120,255,214,.12), transparent 40%),
        radial-gradient(900px 600px at 90% 20%, rgba(138,243,255,.14), transparent 35%),
        radial-gradient(1000px 700px at 50% 110%, rgba(255,173,234,.12), transparent 40%),
        var(--bg);
      backdrop-filter: var(--blur);
    }
    html, body {
      height: 100%;
    }
    body {
      margin: 0; color: var(--txt); background: var(--bg);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
      display: grid; grid-template-rows: auto 1fr auto;
    }
    header, footer {
      padding: 14px clamp(14px, 2.5vw, 28px);
      position: sticky; top: 0; z-index: 50;
      backdrop-filter: var(--blur);
      background: linear-gradient(to bottom, rgba(0,0,0,.25), transparent);
    }
    [data-theme="light"] header { background: linear-gradient(to bottom, rgba(255,255,255,.7), rgba(255,255,255,0)); }
    .bar {
      display: flex; align-items: center; gap: 10px; justify-content: space-between;
      max-width: 1100px; margin: 0 auto;
    }
    .brand { display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.2px; }
    .logo {
      width: 36px; height: 36px; border-radius: 12px;
      background: conic-gradient(from 210deg, #a8ff78, #8af3ff, #ffadea, #a8ff78);
      box-shadow: inset 0 0 0 2px rgba(255,255,255,.35), var(--shadow);
      display:grid; place-items:center; font-size:20px;
    }
    .chip { padding: 6px 10px; border-radius: 999px; background: var(--card); box-shadow: inset 0 0 0 1px var(--elev); color: var(--muted); }
    main { padding: 22px clamp(14px,2.5vw,28px) 28px; }
    .wrap { max-width: 1100px; margin: 0 auto; display: grid; gap: 18px; }
    .grid {
      display: grid; gap: 18px;
      grid-template-columns: 1.1fr 1fr;
    }
    @media (max-width: 980px) {
      .grid { grid-template-columns: 1fr; }
    }
    .card {
      background: var(--card); border-radius: var(--radius);
      box-shadow: var(--shadow), inset 0 0 0 1px var(--elev);
      padding: clamp(16px, 2vw, 22px);
      backdrop-filter: var(--blur);
    }
    h1 { margin: 0 0 6px; font-size: clamp(24px, 3vw, 34px); }
    h2 { margin: 0 0 12px; font-size: clamp(18px, 2.2vw, 22px); }
    .muted { color: var(--muted); }
    .controls { display:flex; flex-wrap: wrap; gap: 8px; align-items:center; }
    select, input[type="number"], input[type="date"], button, .btn {
      border: none; outline: none; border-radius: 12px;
      background: var(--card); color: var(--txt);
      box-shadow: inset 0 0 0 1px var(--elev);
      padding: 10px 12px; font-size: 14px;
    }
    button, .btn { cursor: pointer; transition: transform .05s ease, box-shadow .2s ease, background .2s ease; }
    button:hover, .btn:hover { transform: translateY(-1px); }
    .btn.primary { background: linear-gradient(135deg, var(--acc), #8af3ff); color: #001018; box-shadow: var(--shadow); }
    .btn.ghost { background: transparent; box-shadow: inset 0 0 0 1px var(--elev); }
    .btn.ok { background: linear-gradient(135deg, var(--ok), #b3ffcc); color: #00140a; }
    .btn.warn { background: linear-gradient(135deg, var(--warn), #ffe9a8); color: #261a00; }
    .row { display:flex; gap: 10px; flex-wrap: wrap; }
    .kpis { display: grid; grid-template-columns: repeat(4,1fr); gap: 12px; }
    @media (max-width: 760px){ .kpis { grid-template-columns: repeat(2,1fr);} }
    .kpi { padding: 14px; border-radius: 14px; background: linear-gradient(180deg, rgba(255,255,255,.06), transparent); box-shadow: inset 0 0 0 1px var(--elev); }
    .kpi b { font-size: 22px; display:block; margin-top: 6px; }
    .list { display: grid; gap: 10px; }
    .item {
      display:flex; gap: 12px; align-items: center; justify-content: space-between;
      padding: 12px; border-radius: 12px; background: rgba(255,255,255,.05); box-shadow: inset 0 0 0 1px var(--elev);
    }
    .item .title { font-weight: 600; }
    .badge { padding: 4px 8px; border-radius: 999px; font-size: 12px; background: rgba(255,255,255,.08); color: var(--muted); box-shadow: inset 0 0 0 1px var(--elev);}
    .progress { height: 10px; background: rgba(255,255,255,.08); border-radius: 999px; overflow: hidden; }
    .progress > span { display:block; height:100%; background: linear-gradient(90deg, var(--acc), #8af3ff); }
    .split { display:grid; grid-template-columns: 1fr auto; align-items:center; gap: 10px; }
    .stack { display:grid; gap: 12px; }
    .pill { padding: 8px 10px; border-radius: 999px; background: rgba(255,255,255,.07); box-shadow: inset 0 0 0 1px var(--elev);}
    .install-tip { display:none; }
    .theme-toggle { display:flex; gap:6px; }
    .theme-toggle button { padding: 8px 10px; }
    footer { text-align:center; color: var(--muted); }
    .disclaimer { font-size: 12px; color: var(--muted); }
    .hr { height:1px; background: var(--elev); margin: 6px 0 14px; opacity:.7; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; font-size: 12px; color: var(--muted); }
  </style>
</head>
<body>
  <header>
    <div class="bar">
      <div class="brand">
        <div class="logo">üè†</div>
        <div>
          <div>IronHome</div>
          <div class="mono">–≥—Ä—É–¥—å ‚Ä¢ –±–∏—Ü–µ–ø—Å ‚Ä¢ —Ç—Ä–∏—Ü–µ–ø—Å ‚Äî –±–µ–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è</div>
        </div>
      </div>
      <div class="controls">
        <div class="theme-toggle" role="group" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã">
          <button class="btn ghost" data-set-theme="light" title="–°–≤–µ—Ç–ª–∞—è">‚òÄÔ∏è</button>
          <button class="btn ghost" data-set-theme="dark" title="–¢—ë–º–Ω–∞—è">üåô</button>
          <button class="btn ghost" data-set-theme="aurora" title="Aurora">ü´ß</button>
        </div>
        <button class="btn" id="installBtn" style="display:none">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
        <button class="btn" id="exportBtn" title="–≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞">–≠–∫—Å–ø–æ—Ä—Ç</button>
        <input type="file" id="importInput" accept="application/json" style="display:none" />
        <button class="btn" id="importBtn" title="–ò–º–ø–æ—Ä—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞">–ò–º–ø–æ—Ä—Ç</button>
      </div>
    </div>
  </header>

  <main>
    <div class="wrap">
      <section class="grid">
        <div class="card">
          <h1>–¢–≤–æ—è —É–º–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</h1>
          <div class="muted">–ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ —Ç–≤–æ–π —É—Ä–æ–≤–µ–Ω—å —á–µ—Ä–µ–∑ RPE/RIR –∏ –∞–≤—Ç–æ-–ø—Ä–æ–≥—Ä–µ—Å—Å–∏—é. –í—Å—ë –¥–æ–º–∞, –±–µ–∑ –ø—Ä–µ–¥–º–µ—Ç–æ–≤.</div>
          <div class="hr"></div>

          <div class="kpis" id="kpis">
            <div class="kpi"><div class="muted">–ù–µ–¥–µ–ª—è</div><b id="kpiWeek">1</b></div>
            <div class="kpi"><div class="muted">–°–µ—Å—Å–∏—è</div><b id="kpiSession">A</b></div>
            <div class="kpi"><div class="muted">–û–±—ä—ë–º (–ø–æ–≤—Ç.)</div><b id="kpiVolume">0</b></div>
            <div class="kpi"><div class="muted">–ü–æ—Å–ª–µ–¥–Ω—è—è RPE</div><b id="kpiRPE">‚Äî</b></div>
          </div>

          <div class="hr"></div>
          <div class="stack">
            <div class="split">
              <h2>–¢–µ–∫—É—â–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</h2>
              <div class="row">
                <button class="btn primary" id="startBtn">–°—Ç–∞—Ä—Ç/–û–±–Ω–æ–≤–∏—Ç—å</button>
                <button class="btn ok" id="completeBtn">–û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π</button>
                <button class="btn warn" id="skipBtn">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
              </div>
            </div>
            <div class="list" id="workoutList"></div>
            <div class="disclaimer">–ü–æ–¥—Å–∫–∞–∑–∫–∞: –∏—Å–ø–æ–ª—å–∑—É–π —á–µ—Å—Ç–Ω—É—é RPE (10 = –æ—Ç–∫–∞–∑). –†–µ–≥—É–ª–∏—Ä—É–π –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∞–ª–∞—Å—å —Ü–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞.</div>
          </div>
        </div>

        <div class="card">
          <h2>–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞</h2>
          <div class="stack">
            <div class="row">
              <div class="pill">–£—Ä–æ–≤–µ–Ω—å: 
                <select id="level">
                  <option value="novice">–ù–æ–≤–∏—á–æ–∫</option>
                  <option value="intermediate">–°—Ä–µ–¥–Ω–∏–π</option>
                  <option value="advanced">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</option>
                </select>
              </div>
              <div class="pill">–¶–µ–ª—å:
                <select id="goal">
                  <option value="balanced">–°–±–∞–ª–∞–Ω—Å</option>
                  <option value="strength">–°–∏–ª–∞</option>
                  <option value="hypertrophy">–ú–∞—Å—Å–∞</option>
                </select>
              </div>
            </div>

            <div class="row">
              <label class="pill">–ú–∞–∫—Å –æ—Ç–∂–∏–º–∞–Ω–∏–π (1 –ø–æ–¥—Ö–æ–¥): <input type="number" id="maxPush" min="1" max="200" value="15" style="width:88px"></label>
              <label class="pill">RPE –ø—Ä–∏ –º–∞–∫—Å-–ø–æ–¥—Ö–æ–¥–µ: 
                <select id="maxRPE">
                  <option>7</option><option>8</option><option selected>9</option><option>10</option>
                </select>
              </label>
              <button class="btn" id="saveBaseline">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –±–∞–∑—É</button>
            </div>

            <div class="stack">
              <div class="muted">–ú–µ—Ç–æ–¥–∏–∫–∞:</div>
              <div class="item">
                <div>
                  <div class="title">A/B-–º–∏–∫—Ä–æ—Ü–∏–∫–ª ‚Ä¢ 3 –¥–Ω—è/–Ω–µ–¥</div>
                  <div class="muted">A: –≥—Ä—É–¥—å+—Ç—Ä–∏—Ü ‚Ä¢ B: –≥—Ä—É–¥—å+–±–∏—Ü ‚Ä¢ RIR-—Ä–µ–≥—É–ª—è—Ü–∏—è, –∞–≤—Ç–æ-–ø—Ä–æ–≥—Ä–µ—Å—Å, —Ñ–æ–∫—É—Å –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —Ç–µ—Ö–Ω–∏–∫–µ.</div>
                </div>
                <span class="badge">–Ω–∞—É—á–Ω—ã–π RPE/RIR</span>
              </div>
              <div class="item">
                <div>
                  <div class="title">–ë–µ–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è ‚Äî —á–∏—Å—Ç–æ —Ç–µ–ª–æ</div>
                  <div class="muted">–í–∞—Ä–∏–∞—Ü–∏–∏ –æ—Ç–∂–∏–º–∞–Ω–∏–π + —Å–∞–º–æ-—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ –¥–ª—è –±–∏—Ü–µ–ø—Å–∞/—Ç—Ä–∏—Ü–µ–ø—Å–∞ (—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∏–∑–æ–º–µ—Ç—Ä–∏–∫–∏ –∏ —Å–ª–æ–∂–Ω—ã–µ —É–≥–ª—ã).</div>
                </div>
                <span class="badge">–¥–æ–º–∞</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="card">
        <h2>–ò—Å—Ç–æ—Ä–∏—è –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å</h2>
        <div class="list" id="history"></div>
      </section>

      <section class="card">
        <h2>–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π (0 –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è)</h2>
        <div class="list" id="library"></div>
      </section>
    </div>
  </main>

  <footer>
    <div>¬© <span id="year"></span> IronHome ‚Ä¢ PWA ‚Ä¢ –æ—Ñ–ª–∞–π–Ω ‚Ä¢ –±–µ–∑ —Ç—Ä–µ–∫–∏–Ω–≥–∞</div>
  </footer>

  <script>
  // ======= PWA install =======
  let deferredPrompt;
  const installBtn = document.getElementById('installBtn');
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    installBtn.style.display = 'inline-block';
  });
  installBtn?.addEventListener('click', async () => {
    if (!deferredPrompt) return;
    deferredPrompt.prompt();
    await deferredPrompt.userChoice;
    deferredPrompt = null;
    installBtn.style.display = 'none';
  });

  // ======= Service Worker =======
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('./sw.js').catch(console.error);
    });
  }

  // ======= Theme =======
  const themeButtons = document.querySelectorAll('[data-set-theme]');
  const setTheme = (t) => {
    document.documentElement.setAttribute('data-theme', t);
    localStorage.setItem('ih_theme', t);
  };
  setTheme(localStorage.getItem('ih_theme') || 'dark');
  themeButtons.forEach(b => b.addEventListener('click', () => setTheme(b.dataset.setTheme)));

  // ======= Data & Model =======
  const $ = (id)=>document.getElementById(id);
  const state = {
    baseline: JSON.parse(localStorage.getItem('ih_baseline') || '{}'),
    history: JSON.parse(localStorage.getItem('ih_history') || '[]'),
    week: parseInt(localStorage.getItem('ih_week') || '1', 10),
    sessionIndex: parseInt(localStorage.getItem('ih_sessionIndex') || '0', 10), // 0:A, 1:B
    volume: 0,
    lastRPE: null,
  };

  const EXERCISES = [
    // –ì–†–£–î–¨ + –¢–†–ò–¶
    { key:'push_std', name:'–û—Ç–∂–∏–º–∞–Ω–∏—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ', muscle:'–≥—Ä—É–¥—å/—Ç—Ä–∏—Ü', type:'reps',
      cues:'–ö–æ—Ä–ø—É—Å –µ–¥–∏–Ω—ã–º –±–ª–æ–∫–æ–º, –ª–æ–∫—Ç–∏ ~30-45¬∞.', levels:{novice:[6,10], intermediate:[10,16], advanced:[16,24]} },
    { key:'push_diamond', name:'–ê–ª–º–∞–∑–Ω—ã–µ –æ—Ç–∂–∏–º–∞–Ω–∏—è', muscle:'—Ç—Ä–∏—Ü/–≥—Ä—É–¥—å', type:'reps',
      cues:'–ö–∏—Å—Ç–∏ —Ä–æ–º–±–æ–º –ø–æ–¥ –≥—Ä—É–¥—å—é. –î–µ—Ä–∂–∏ –ª–æ–∫—Ç–∏ –±–ª–∏–∑–∫–æ.', levels:{novice:[4,8], intermediate:[8,12], advanced:[12,18]} },
    { key:'push_lean', name:'–ü—Å–µ–≤–¥–æ-–ø–ª–∞–Ω—à –Ω–∞–∫–ª–æ–Ω', muscle:'–ø–µ—Ä–µ–¥–Ω. –ø–ª–µ—á–æ/–≥—Ä—É–¥—å/—Ç—Ä–∏—Ü', type:'seconds',
      cues:'–ü–ª–µ—á–∏ –Ω–∞–¥ –∫–∏—Å—Ç—è–º–∏, –∫–æ—Ä–ø—É—Å –≤–ø–µ—Ä—ë–¥, –ª–æ–ø–∞—Ç–∫–∏ –ø—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ.', levels:{novice:[15,25], intermediate:[25,40], advanced:[40,60]} },

    // –ì–†–£–î–¨ + –ë–ò–¶ (—Å–∞–º–æ-—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ)
    { key:'curl_sr', name:'–°–∞–º–æ-curl (–ª–∞–¥–æ–Ω—å –ø—Ä–æ—Ç–∏–≤ –ª–∞–¥–æ–Ω–∏)', muscle:'–±–∏—Ü', type:'seconds',
      cues:'–û–¥–Ω–æ–π —Ä—É–∫–æ–π —Ç—è–Ω–∏ –≤–≤–µ—Ä—Ö, –¥—Ä—É–≥–æ–π —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –¥–∞–≤–∏ –≤–Ω–∏–∑. –î—ã—Ö–∞–Ω–∏–µ —Ä–æ–≤–Ω–æ.', levels:{novice:[20,30], intermediate:[30,45], advanced:[45,60]} },
    { key:'curl_iso_thigh', name:'–ò–∑–æ–º–µ—Ç—Ä–∏—è –±–∏—Ü–µ–ø—Å–∞ –ø–æ–¥ –±–µ–¥—Ä–æ–º', muscle:'–±–∏—Ü', type:'seconds',
      cues:'–°–∏–¥—è: –ø—Ä–µ–¥–ø–ª–µ—á—å–µ —Ç—è–Ω–µ—Ç –≤–≤–µ—Ä—Ö, –±–µ–¥—Ä–æ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª—è–µ—Ç—Å—è. –ò–∑–æ–º–µ—Ç—Ä–∏—è —Å—Ä–µ–¥–Ω–µ–π-–≤—ã—Å–æ–∫–æ–π –º–æ—â–Ω–æ—Å—Ç–∏.', levels:{novice:[20,30], intermediate:[30,45], advanced:[45,60]} },

    // –¢–†–ò–¶ –±–µ–∑ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
    { key:'triceps_floor_press', name:'–ò–∑–æ–º–µ—Ç—Ä–∏—è —Ç—Ä–∏—Ü–µ–ø—Å–∞ —Å–∏–¥—è —Å–∑–∞–¥–∏ —É–ø–æ—Ä', muscle:'—Ç—Ä–∏—Ü', type:'seconds',
      cues:'–°–∏–¥—è, –∫–∏—Å—Ç–∏ —Å–∑–∞–¥–∏ –Ω–∞ –ø–æ–ª—É, –ø—ã—Ç–∞–π—Å—è ¬´—Ä–∞—Å–ø—Ä—è–º–∏—Ç—å¬ª –ª–æ–∫–æ—Ç—å –Ω–µ –æ—Ç—Ä—ã–≤–∞—è —Ç–∞–∑ (–¥–∞–≤–ª–µ–Ω–∏–µ –≤ –ø–æ–ª).', levels:{novice:[20,30], intermediate:[30,45], advanced:[45,60]} },

    // –î–æ–ø. –≤–∞—Ä–∏–∞—Ü–∏–∏ –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å
    { key:'push_archer', name:'–û—Ç–∂–∏–º–∞–Ω–∏—è –ª—É—á–Ω–∏–∫–æ–º (–ø—Å–µ–≤–¥–æ)', muscle:'–≥—Ä—É–¥—å/—Ç—Ä–∏—Ü', type:'reps',
      cues:'–°–º–µ—â–∞–π –≤–µ—Å –Ω–∞ –æ–¥–Ω—É —Ä—É–∫—É, –¥—Ä—É–≥–∞—è ‚Äî –æ–ø–æ—Ä–∞ –Ω–∞ –ø–∞–ª—å—Ü–∞—Ö.', levels:{novice:[3,6], intermediate:[6,10], advanced:[10,14]} },
  ];

  const LIBRARY_DESCR = {
    push_std:'–ë–∞–∑–∞. –†–µ–≥—É–ª–∏—Ä—É–π —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ç–µ–º–ø–æ–º: 3—Å –≤–Ω–∏–∑, –ø–∞—É–∑–∞ 1—Å –≤–Ω–∏–∑—É.',
    push_diamond:'–ë–æ–ª—å—à–µ –∞–∫—Ü–µ–Ω—Ç–∞ –Ω–∞ —Ç—Ä–∏—Ü–µ–ø—Å –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –≥—Ä—É–¥—å.',
    push_lean:'–°–º–µ—â–∞–π —Ü–µ–Ω—Ç—Ä —Ç—è–∂–µ—Å—Ç–∏ –≤–ø–µ—Ä—ë–¥, –¥–µ—Ä–∂–∏ –ª–æ–ø–∞—Ç–∫–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ.',
    curl_sr:'10‚Äì15—Å ¬´–≤—ã—Ö–æ–¥¬ª + 10‚Äì15—Å ¬´—É–¥–µ—Ä–∂–∞–Ω–∏–µ¬ª = 1 –ø–æ–¥—Ö–æ–¥.',
    curl_iso_thigh:'–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π —à–µ—é –∏ –æ—Å–∞–Ω–∫—É, –Ω–µ —Ç—É–∂—å—Å—è.',
    triceps_floor_press:'–î–∞–≤–∏ —Ä—É–∫–∞–º–∏ –≤ –ø–æ–ª, —á—É–≤—Å—Ç–≤—É—è –∑–∞–¥–Ω—é—é –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å —Ä—É–∫–∏.',
    push_archer:'–°–ª–µ–¥–∏ –∑–∞ —Ä–æ–≤–Ω–æ–π –ª–∏–Ω–∏–µ–π –∫–æ—Ä–ø—É—Å–∞, –Ω–µ –ø—Ä–æ–≤–∞–ª–∏–≤–∞–π—Å—è –≤ –ø–ª–µ—á–∞—Ö.',
  };

  function save() {
    localStorage.setItem('ih_baseline', JSON.stringify(state.baseline));
    localStorage.setItem('ih_history', JSON.stringify(state.history));
    localStorage.setItem('ih_week', String(state.week));
    localStorage.setItem('ih_sessionIndex', String(state.sessionIndex));
  }

  // ======= Baseline =======
  function initBaselineUI() {
    if (state.baseline.level) {
      $('level').value = state.baseline.level;
      $('goal').value = state.baseline.goal;
      $('maxPush').value = state.baseline.maxPush;
      $('maxRPE').value = state.baseline.maxRPE;
    }
    $('saveBaseline').addEventListener('click', () => {
      state.baseline = {
        level: $('level').value,
        goal: $('goal').value,
        maxPush: Math.max(1, parseInt($('maxPush').value||'1',10)),
        maxRPE: parseInt($('maxRPE').value||'9',10),
      };
      save();
      genWorkout();
    });
  }

  // ======= Workout Generator =======
  function repRange(key){
    const lvl = state.baseline.level || 'novice';
    const ex = EXER
